<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 500">
  <defs>
    <style>
      .title { font: bold 20px sans-serif; fill: #333; }
      .subtitle { font: bold 14px sans-serif; fill: #666; }
      .label { font: 14px sans-serif; fill: #666; }
      .small-text { font: 12px sans-serif; fill: #999; }
      .infer-box { fill: #ffe6e6; stroke: #cc0000; stroke-width: 2; }
      .resize-box { fill: #e6ffe6; stroke: #00cc00; stroke-width: 2; }
      .launch-box { fill: #e6e6ff; stroke: #0000cc; stroke-width: 2; }
      .pipeline { stroke: #666; stroke-width: 2; fill: none; }
      .arrow { stroke: #666; stroke-width: 2; fill: none; }
    </style>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#666" />
    </marker>
  </defs>
  
  <!-- 标题 -->
  <text x="450" y="30" class="title" text-anchor="middle">技术三：三级流水（3-Stage Pipeline）</text>
  
  <!-- 串行模式对比 -->
  <g transform="translate(50, 60)">
    <text x="0" y="0" class="subtitle" fill="#cc0000">串行模式（传统）</text>
    
    <!-- 算子1 -->
    <g id="serial-op1">
      <text x="0" y="35" class="small-text">算子1:</text>
      <rect x="50" y="20" width="50" height="25" class="infer-box" rx="3"/>
      <text x="75" y="37" class="small-text" text-anchor="middle" font-size="10">Infer</text>
      <text x="75" y="50" class="small-text" text-anchor="middle" font-size="8">10μs</text>
      
      <rect x="105" y="20" width="80" height="25" class="resize-box" rx="3"/>
      <text x="145" y="37" class="small-text" text-anchor="middle" font-size="10">Resize</text>
      <text x="145" y="50" class="small-text" text-anchor="middle" font-size="8">20μs</text>
      
      <rect x="190" y="20" width="100" height="25" class="launch-box" rx="3"/>
      <text x="240" y="37" class="small-text" text-anchor="middle" font-size="10">Launch</text>
      <text x="240" y="50" class="small-text" text-anchor="middle" font-size="8">30μs</text>
    </g>
    
    <!-- 等待 -->
    <text x="300" y="37" class="small-text" fill="#cc0000">⟹ 必须等待</text>
    
    <!-- 算子2 -->
    <g id="serial-op2" transform="translate(0, 60)">
      <text x="0" y="35" class="small-text">算子2:</text>
      <rect x="50" y="20" width="50" height="25" class="infer-box" rx="3"/>
      <text x="75" y="37" class="small-text" text-anchor="middle" font-size="10">Infer</text>
      
      <rect x="105" y="20" width="80" height="25" class="resize-box" rx="3"/>
      <text x="145" y="37" class="small-text" text-anchor="middle" font-size="10">Resize</text>
      
      <rect x="190" y="20" width="100" height="25" class="launch-box" rx="3"/>
      <text x="240" y="37" class="small-text" text-anchor="middle" font-size="10">Launch</text>
    </g>
    
    <text x="350" y="60" class="label" fill="#cc0000">总耗时：180μs</text>
  </g>
  
  <!-- 三级流水模式 -->
  <g transform="translate(50, 220)">
    <text x="0" y="0" class="subtitle" fill="#00cc00">三级流水模式（优化）</text>
    
    <!-- 队列标签 -->
    <g transform="translate(50, 20)">
      <text x="75" y="0" class="label" text-anchor="middle" fill="#cc0000">InferQueue</text>
      <text x="225" y="0" class="label" text-anchor="middle" fill="#00cc00">ResizeQueue</text>
      <text x="415" y="0" class="label" text-anchor="middle" fill="#0000cc">LaunchQueue</text>
    </g>
    
    <!-- 时间轴 -->
    <line x1="50" y1="40" x2="650" y2="40" stroke="#333" stroke-width="2"/>
    <text x="50" y="30" class="small-text">T=0</text>
    <text x="150" y="30" class="small-text">T=10μs</text>
    <text x="250" y="30" class="small-text">T=30μs</text>
    <text x="450" y="30" class="small-text">T=60μs</text>
    <text x="630" y="30" class="small-text">T=80μs</text>
    
    <!-- 算子1流水 -->
    <g id="pipeline-op1">
      <rect x="50" y="50" width="50" height="25" class="infer-box" rx="3" opacity="0">
        <animate attributeName="opacity" values="0;1;1;1;1;1;1;1" keyTimes="0;0.1;0.2;0.3;0.5;0.7;0.9;1" dur="6s" repeatCount="indefinite"/>
      </rect>
      <text x="75" y="67" class="small-text" text-anchor="middle" font-size="10">Op1</text>
      
      <path d="M 100,62 L 145,62" class="arrow" marker-end="url(#arrow)" opacity="0">
        <animate attributeName="opacity" values="0;0;1;1;1;1;1;1" keyTimes="0;0.1;0.2;0.3;0.5;0.7;0.9;1" dur="6s" repeatCount="indefinite"/>
      </path>
      
      <rect x="150" y="50" width="80" height="25" class="resize-box" rx="3" opacity="0">
        <animate attributeName="opacity" values="0;0;1;1;1;1;1;1" keyTimes="0;0.1;0.2;0.3;0.5;0.7;0.9;1" dur="6s" repeatCount="indefinite"/>
      </rect>
      <text x="190" y="67" class="small-text" text-anchor="middle" font-size="10">Op1</text>
      
      <path d="M 230,62 L 305,62" class="arrow" marker-end="url(#arrow)" opacity="0">
        <animate attributeName="opacity" values="0;0;0;1;1;1;1;1" keyTimes="0;0.1;0.2;0.3;0.5;0.7;0.9;1" dur="6s" repeatCount="indefinite"/>
      </path>
      
      <rect x="310" y="50" width="100" height="25" class="launch-box" rx="3" opacity="0">
        <animate attributeName="opacity" values="0;0;0;1;1;1;1;1" keyTimes="0;0.1;0.2;0.3;0.5;0.7;0.9;1" dur="6s" repeatCount="indefinite"/>
      </rect>
      <text x="360" y="67" class="small-text" text-anchor="middle" font-size="10">Op1</text>
    </g>
    
    <!-- 算子2流水（与Op1并行）-->
    <g id="pipeline-op2">
      <rect x="110" y="85" width="50" height="25" class="infer-box" rx="3" opacity="0">
        <animate attributeName="opacity" values="0;0;1;1;1;1;1;1" keyTimes="0;0.1;0.2;0.3;0.5;0.7;0.9;1" dur="6s" repeatCount="indefinite"/>
      </rect>
      <text x="135" y="102" class="small-text" text-anchor="middle" font-size="10">Op2</text>
      
      <path d="M 160,97 L 215,97" class="arrow" marker-end="url(#arrow)" opacity="0">
        <animate attributeName="opacity" values="0;0;0;1;1;1;1;1" keyTimes="0;0.1;0.2;0.3;0.5;0.7;0.9;1" dur="6s" repeatCount="indefinite"/>
      </path>
      
      <rect x="220" y="85" width="80" height="25" class="resize-box" rx="3" opacity="0">
        <animate attributeName="opacity" values="0;0;0;1;1;1;1;1" keyTimes="0;0.1;0.2;0.3;0.5;0.7;0.9;1" dur="6s" repeatCount="indefinite"/>
      </rect>
      <text x="260" y="102" class="small-text" text-anchor="middle" font-size="10">Op2</text>
      
      <path d="M 300,97 L 395,97" class="arrow" marker-end="url(#arrow)" opacity="0">
        <animate attributeName="opacity" values="0;0;0;0;1;1;1;1" keyTimes="0;0.1;0.2;0.3;0.5;0.7;0.9;1" dur="6s" repeatCount="indefinite"/>
      </path>
      
      <rect x="400" y="85" width="100" height="25" class="launch-box" rx="3" opacity="0">
        <animate attributeName="opacity" values="0;0;0;0;1;1;1;1" keyTimes="0;0.1;0.2;0.3;0.5;0.7;0.9;1" dur="6s" repeatCount="indefinite"/>
      </rect>
      <text x="450" y="102" class="small-text" text-anchor="middle" font-size="10">Op2</text>
    </g>
    
    <!-- 算子3流水（与Op1、Op2并行）-->
    <g id="pipeline-op3">
      <rect x="170" y="120" width="50" height="25" class="infer-box" rx="3" opacity="0">
        <animate attributeName="opacity" values="0;0;0;1;1;1;1;1" keyTimes="0;0.1;0.2;0.3;0.5;0.7;0.9;1" dur="6s" repeatCount="indefinite"/>
      </rect>
      <text x="195" y="137" class="small-text" text-anchor="middle" font-size="10">Op3</text>
      
      <path d="M 220,132 L 295,132" class="arrow" marker-end="url(#arrow)" opacity="0">
        <animate attributeName="opacity" values="0;0;0;0;1;1;1;1" keyTimes="0;0.1;0.2;0.3;0.5;0.7;0.9;1" dur="6s" repeatCount="indefinite"/>
      </path>
      
      <rect x="300" y="120" width="80" height="25" class="resize-box" rx="3" opacity="0">
        <animate attributeName="opacity" values="0;0;0;0;1;1;1;1" keyTimes="0;0.1;0.2;0.3;0.5;0.7;0.9;1" dur="6s" repeatCount="indefinite"/>
      </rect>
      <text x="340" y="137" class="small-text" text-anchor="middle" font-size="10">Op3</text>
      
      <path d="M 380,132 L 495,132" class="arrow" marker-end="url(#arrow)" opacity="0">
        <animate attributeName="opacity" values="0;0;0;0;0;1;1;1" keyTimes="0;0.1;0.2;0.3;0.5;0.7;0.9;1" dur="6s" repeatCount="indefinite"/>
      </path>
      
      <rect x="500" y="120" width="100" height="25" class="launch-box" rx="3" opacity="0">
        <animate attributeName="opacity" values="0;0;0;0;0;0;1;1" keyTimes="0;0.1;0.2;0.3;0.5;0.7;0.9;1" dur="6s" repeatCount="indefinite"/>
      </rect>
      <text x="550" y="137" class="small-text" text-anchor="middle" font-size="10">Op3</text>
    </g>
    
    <!-- 并行标注 -->
    <g id="parallel-annotation">
      <path d="M 105,75 L 105,60 L 225,60 L 225,50" stroke="#ff9900" stroke-width="2" stroke-dasharray="3,3" opacity="0">
        <animate attributeName="opacity" values="0;0;1;1;1;1;1;1" keyTimes="0;0.1;0.2;0.3;0.5;0.7;0.9;1" dur="6s" repeatCount="indefinite"/>
      </path>
      <text x="165" y="72" class="small-text" fill="#ff9900" text-anchor="middle" opacity="0">
        并行
        <animate attributeName="opacity" values="0;0;1;1;1;1;1;1" keyTimes="0;0.1;0.2;0.3;0.5;0.7;0.9;1" dur="6s" repeatCount="indefinite"/>
      </text>
    </g>
    
    <text x="700" y="90" class="label" fill="#00cc00">总耗时：80μs</text>
    <text x="680" y="110" class="label" fill="#00cc00">⬇ 性能提升55.6%</text>
  </g>
  
  <!-- 关键优势 -->
  <g transform="translate(50, 450)">
    <text x="0" y="0" class="label" fill="#00cc00">✓ 流水线并行：三个队列同时工作，算子间不再串行等待</text>
  </g>
</svg>

