本节介绍 Tile 内核，它是 GPU 程序的入口点。

内核是 Tile Code 的入口点，使用 @ct.kernel 装饰器定义。Grid 中的每个 Block 都会并行执行这个内核函数。注意，内核不能直接调用，必须使用 ct.launch 函数来启动。

让我们看左边的基本内核示例，这是一个向量加法。

内核定义使用 @ct.kernel 装饰器。内核的执行流程分为四步：

第一步，获取 Block ID。使用 ct.bid(0) 获取当前 Block 在第一维的索引，这个索引叫做 pid。

第二步，加载数据 Tile。使用 ct.load 函数，传入数组 a，指定索引位置和形状。这里每个 Block 加载 16 个元素的 Tile。对 b 数组做同样的操作。

第三步，Tile 计算。直接对两个 Tile 进行加法运算，这个操作会在多个线程上并行执行，但对程序员来说是透明的。

第四步，存储结果。使用 ct.store 函数将计算结果 Tile 写回到数组 c 中。

在 Host 端，我们准备数据，计算需要多少个 Block，设置 grid 参数，然后调用 ct.launch 启动内核。

再看右边的二维 Grid 示例，这是处理矩阵的场景。

内核函数使用 ct.bid(0) 获取行索引，ct.bid(1) 获取列索引。加载 2D Tile 时，index 参数是 (row, col)，shape 是 (16, 16)，表示加载一个 16 乘 16 的矩阵块。

启动时，grid 参数设置为 (grid_y, grid_x, 1)，表示一个二维网格，有 16 行 16 列共 256 个 Block。

记住内核执行的关键流程：第一步获取 Block ID，第二步加载 Tile，第三步进行计算，第四步存储结果。所有的 Block 都在并行执行这个流程，这就是 GPU 的强大之处！

