现在，让我们通过一个完整的向量加法示例，把前面学到的所有知识串联起来。

看左侧的代码。首先导入必要的库：cupy 和 cuda.tile。

第一步，使用 @ct.kernel 装饰器定义内核函数 vector_add。

第二步，在函数内部，通过 ct.bid(0) 获取当前处理器的索引 pid。

第三步，使用 ct.load 加载数据。我们加载两个 Tile：a_tile 和 b_tile。注意，index 参数使用的是 pid，shape 参数是 tile_size。

第四步，执行计算。这里非常简单，直接用加号进行 Tile 级别的逐元素加法。

第五步，使用 ct.store 将结果存储回输出数组 c。

内核函数定义完成后，我们需要启动它。

首先准备数据：向量大小是 4096 个元素，每个 Tile 包含 16 个元素，所以需要 256 个处理器，也就是 grid = (256, 1, 1)。

然后调用 ct.launch 启动内核，传入流对象、网格大小、内核函数和参数。

再看右侧的执行流程图。

整个过程分为五步：首先启动 256 个处理器，然后每个处理器获取自己的索引 pid，接着加载对应的 Tile 数据，进行并行计算 a 加 b，最后存储结果到输出数组。

这就是一个完整的 cuTile 程序！代码简洁，逻辑清晰，256 个处理器同时工作，效率极高。
